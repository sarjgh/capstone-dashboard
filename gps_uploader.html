<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#ffffff" />
  <title>GPS ìœ„ì¹˜ ì—…ë¡œë”</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>
  <h2>ğŸ“¡ GPS ìœ„ì¹˜ ì—…ë¡œë“œ ì¤‘...</h2>
  <p id="lat">ğŸ“ ìœ„ë„: -</p>
  <p id="lng">ğŸ“ ê²½ë„: -</p>
  <p id="timestamp">ğŸ•’ ë§ˆì§€ë§‰ ì „ì†¡ ì‹œê°„: -</p>
  <button onclick="window.open('https://sarjgh.github.io/capstone-dashboard/', '_blank')">ğŸ“Š ëŒ€ì‹œë³´ë“œ ë³´ê¸°</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCTI9qiQ0jJPCH_MoQJ5mVjBjvD3zQkpIU",
      authDomain: "capstonedesign-fe014.firebaseapp.com",
      databaseURL: "https://capstonedesign-fe014-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "capstonedesign-fe014",
      storageBucket: "capstonedesign-fe014.appspot.com",
      messagingSenderId: "187566571167",
      appId: "1:187566571167:web:6d596a12d4d8ce34472caa",
      measurementId: "G-HGB4T76H6S"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function uploadLocation(position) {
      const lat = position.coords.latitude;
      const lng = position.coords.longitude;
      const now = new Date().toISOString();

      document.getElementById("lat").innerText = `ğŸ“ ìœ„ë„: ${lat}`;
      document.getElementById("lng").innerText = `ğŸ“ ê²½ë„: ${lng}`;
      document.getElementById("timestamp").innerText = `ğŸ•’ ë§ˆì§€ë§‰ ì „ì†¡ ì‹œê°„: ${now}`;

      const data = {
        latitude: lat,
        longitude: lng,
        timestamp: now,
        error: 0
      };

      db.ref("gps_logs").push(data);
    }

    function handleError(err) {
      document.getElementById("lat").innerText = "âŒ ìœ„ì¹˜ ì˜¤ë¥˜: " + err.message;
      document.getElementById("lng").innerText = "";
      document.getElementById("timestamp").innerText = "";
    }

    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(uploadLocation, handleError, {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      });
    } else {
      document.getElementById("lat").innerText = "âš ï¸ ì´ ê¸°ê¸°ì—ì„œ ìœ„ì¹˜ ì‚¬ìš© ë¶ˆê°€.";
    }
  </script>
</body>
</html>
